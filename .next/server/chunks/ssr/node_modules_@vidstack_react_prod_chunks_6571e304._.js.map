{"version":3,"sources":["../../../../node_modules/%40vidstack/react/prod/chunks/vidstack-CQQ1xKSy.js"],"sourcesContent":["\"use client\"\n\nimport { IS_CHROME, canGoogleCastSrc, IS_IOS, IS_SERVER, loadScript } from './vidstack-D5Pzx_k5.js';\nimport { listenEvent, peek } from './vidstack-CZgUA94N.js';\n\nfunction getCastFrameworkURL() {\n  return \"https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1\";\n}\nfunction hasLoadedCastFramework() {\n  return !!window.cast?.framework;\n}\nfunction isCastAvailable() {\n  return !!window.chrome?.cast?.isAvailable;\n}\nfunction isCastConnected() {\n  return getCastContext().getCastState() === cast.framework.CastState.CONNECTED;\n}\nfunction getCastContext() {\n  return window.cast.framework.CastContext.getInstance();\n}\nfunction getCastSession() {\n  return getCastContext().getCurrentSession();\n}\nfunction getCastSessionMedia() {\n  return getCastSession()?.getSessionObj().media[0];\n}\nfunction hasActiveCastSession(src) {\n  const contentId = getCastSessionMedia()?.media.contentId;\n  return contentId === src?.src;\n}\nfunction getDefaultCastOptions() {\n  return {\n    language: \"en-US\",\n    autoJoinPolicy: chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED,\n    receiverApplicationId: chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID,\n    resumeSavedSession: true,\n    androidReceiverCompatible: true\n  };\n}\nfunction getCastErrorMessage(code) {\n  const defaultMessage = `Google Cast Error Code: ${code}`;\n  return defaultMessage;\n}\nfunction listenCastContextEvent(type, handler) {\n  return listenEvent(getCastContext(), type, handler);\n}\n\nclass GoogleCastLoader {\n  name = \"google-cast\";\n  target;\n  #player;\n  /**\n   * @see {@link https://developers.google.com/cast/docs/reference/web_sender/cast.framework.CastContext}\n   */\n  get cast() {\n    return getCastContext();\n  }\n  mediaType() {\n    return \"video\";\n  }\n  canPlay(src) {\n    return IS_CHROME && !IS_IOS && canGoogleCastSrc(src);\n  }\n  async prompt(ctx) {\n    let loadEvent, openEvent, errorEvent;\n    try {\n      loadEvent = await this.#loadCastFramework(ctx);\n      if (!this.#player) {\n        this.#player = new cast.framework.RemotePlayer();\n        new cast.framework.RemotePlayerController(this.#player);\n      }\n      openEvent = ctx.player.createEvent(\"google-cast-prompt-open\", {\n        trigger: loadEvent\n      });\n      ctx.player.dispatchEvent(openEvent);\n      this.#notifyRemoteStateChange(ctx, \"connecting\", openEvent);\n      await this.#showPrompt(peek(ctx.$props.googleCast));\n      ctx.$state.remotePlaybackInfo.set({\n        deviceName: getCastSession()?.getCastDevice().friendlyName\n      });\n      if (isCastConnected()) this.#notifyRemoteStateChange(ctx, \"connected\", openEvent);\n    } catch (code) {\n      const error = code instanceof Error ? code : this.#createError(\n        (code + \"\").toUpperCase(),\n        \"Prompt failed.\"\n      );\n      errorEvent = ctx.player.createEvent(\"google-cast-prompt-error\", {\n        detail: error,\n        trigger: openEvent ?? loadEvent,\n        cancelable: true\n      });\n      ctx.player.dispatch(errorEvent);\n      this.#notifyRemoteStateChange(\n        ctx,\n        isCastConnected() ? \"connected\" : \"disconnected\",\n        errorEvent\n      );\n      throw error;\n    } finally {\n      ctx.player.dispatch(\"google-cast-prompt-close\", {\n        trigger: errorEvent ?? openEvent ?? loadEvent\n      });\n    }\n  }\n  async load(ctx) {\n    if (IS_SERVER) {\n      throw Error(\"[vidstack] can not load google cast provider server-side\");\n    }\n    if (!this.#player) {\n      throw Error(\"[vidstack] google cast player was not initialized\");\n    }\n    return new (await import('./vidstack-BeT6vBOi.js')).GoogleCastProvider(this.#player, ctx);\n  }\n  async #loadCastFramework(ctx) {\n    if (hasLoadedCastFramework()) return;\n    const loadStartEvent = ctx.player.createEvent(\"google-cast-load-start\");\n    ctx.player.dispatch(loadStartEvent);\n    await loadScript(getCastFrameworkURL());\n    await customElements.whenDefined(\"google-cast-launcher\");\n    const loadedEvent = ctx.player.createEvent(\"google-cast-loaded\", { trigger: loadStartEvent });\n    ctx.player.dispatch(loadedEvent);\n    if (!isCastAvailable()) {\n      throw this.#createError(\"CAST_NOT_AVAILABLE\", \"Google Cast not available on this platform.\");\n    }\n    return loadedEvent;\n  }\n  async #showPrompt(options) {\n    this.#setOptions(options);\n    const errorCode = await this.cast.requestSession();\n    if (errorCode) {\n      throw this.#createError(\n        errorCode.toUpperCase(),\n        getCastErrorMessage(errorCode)\n      );\n    }\n  }\n  #setOptions(options) {\n    this.cast?.setOptions({\n      ...getDefaultCastOptions(),\n      ...options\n    });\n  }\n  #notifyRemoteStateChange(ctx, state, trigger) {\n    const detail = { type: \"google-cast\", state };\n    ctx.notify(\"remote-playback-change\", detail, trigger);\n  }\n  #createError(code, message) {\n    const error = Error(message);\n    error.code = code;\n    return error;\n  }\n}\n\nvar loader = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  GoogleCastLoader: GoogleCastLoader\n});\n\nexport { getCastContext, getCastErrorMessage, getCastSession, getCastSessionMedia, hasActiveCastSession, listenCastContextEvent, loader };\n"],"names":[],"mappings":"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","ignoreList":[0]}