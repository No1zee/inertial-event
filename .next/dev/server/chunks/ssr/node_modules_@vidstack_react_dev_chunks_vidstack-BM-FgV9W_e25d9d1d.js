module.exports = [
"[project]/node_modules/@vidstack/react/dev/chunks/vidstack-BM-FgV9W.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getCastContext",
    ()=>getCastContext,
    "getCastErrorMessage",
    ()=>getCastErrorMessage,
    "getCastSession",
    ()=>getCastSession,
    "getCastSessionMedia",
    ()=>getCastSessionMedia,
    "hasActiveCastSession",
    ()=>hasActiveCastSession,
    "listenCastContextEvent",
    ()=>listenCastContextEvent,
    "loader",
    ()=>loader
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$vidstack$2f$react$2f$dev$2f$chunks$2f$vidstack$2d$DUlCophs$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@vidstack/react/dev/chunks/vidstack-DUlCophs.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$vidstack$2f$react$2f$dev$2f$chunks$2f$vidstack$2d$D_bWd66h$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@vidstack/react/dev/chunks/vidstack-D_bWd66h.js [app-ssr] (ecmascript)");
"use client";
;
;
function getCastFrameworkURL() {
    return "https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1";
}
function hasLoadedCastFramework() {
    return !!window.cast?.framework;
}
function isCastAvailable() {
    return !!window.chrome?.cast?.isAvailable;
}
function isCastConnected() {
    return getCastContext().getCastState() === cast.framework.CastState.CONNECTED;
}
function getCastContext() {
    return window.cast.framework.CastContext.getInstance();
}
function getCastSession() {
    return getCastContext().getCurrentSession();
}
function getCastSessionMedia() {
    return getCastSession()?.getSessionObj().media[0];
}
function hasActiveCastSession(src) {
    const contentId = getCastSessionMedia()?.media.contentId;
    return contentId === src?.src;
}
function getDefaultCastOptions() {
    return {
        language: "en-US",
        autoJoinPolicy: chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED,
        receiverApplicationId: chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID,
        resumeSavedSession: true,
        androidReceiverCompatible: true
    };
}
function getCastErrorMessage(code) {
    const defaultMessage = `Google Cast Error Code: ${code}`;
    {
        switch(code){
            case chrome.cast.ErrorCode.API_NOT_INITIALIZED:
                return "The API is not initialized.";
            case chrome.cast.ErrorCode.CANCEL:
                return "The operation was canceled by the user";
            case chrome.cast.ErrorCode.CHANNEL_ERROR:
                return "A channel to the receiver is not available.";
            case chrome.cast.ErrorCode.EXTENSION_MISSING:
                return "The Cast extension is not available.";
            case chrome.cast.ErrorCode.INVALID_PARAMETER:
                return "The parameters to the operation were not valid.";
            case chrome.cast.ErrorCode.RECEIVER_UNAVAILABLE:
                return "No receiver was compatible with the session request.";
            case chrome.cast.ErrorCode.SESSION_ERROR:
                return "A session could not be created, or a session was invalid.";
            case chrome.cast.ErrorCode.TIMEOUT:
                return "The operation timed out.";
            default:
                return defaultMessage;
        }
    }
}
function listenCastContextEvent(type, handler) {
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$vidstack$2f$react$2f$dev$2f$chunks$2f$vidstack$2d$D_bWd66h$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["listenEvent"])(getCastContext(), type, handler);
}
class GoogleCastLoader {
    name = "google-cast";
    target;
    #player;
    /**
   * @see {@link https://developers.google.com/cast/docs/reference/web_sender/cast.framework.CastContext}
   */ get cast() {
        return getCastContext();
    }
    mediaType() {
        return "video";
    }
    canPlay(src) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$vidstack$2f$react$2f$dev$2f$chunks$2f$vidstack$2d$DUlCophs$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["IS_CHROME"] && !__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$vidstack$2f$react$2f$dev$2f$chunks$2f$vidstack$2d$DUlCophs$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["IS_IOS"] && (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$vidstack$2f$react$2f$dev$2f$chunks$2f$vidstack$2d$DUlCophs$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["canGoogleCastSrc"])(src);
    }
    async prompt(ctx) {
        let loadEvent, openEvent, errorEvent;
        try {
            loadEvent = await this.#loadCastFramework(ctx);
            if (!this.#player) {
                this.#player = new cast.framework.RemotePlayer();
                new cast.framework.RemotePlayerController(this.#player);
            }
            openEvent = ctx.player.createEvent("google-cast-prompt-open", {
                trigger: loadEvent
            });
            ctx.player.dispatchEvent(openEvent);
            this.#notifyRemoteStateChange(ctx, "connecting", openEvent);
            await this.#showPrompt((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$vidstack$2f$react$2f$dev$2f$chunks$2f$vidstack$2d$D_bWd66h$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["peek"])(ctx.$props.googleCast));
            ctx.$state.remotePlaybackInfo.set({
                deviceName: getCastSession()?.getCastDevice().friendlyName
            });
            if (isCastConnected()) this.#notifyRemoteStateChange(ctx, "connected", openEvent);
        } catch (code) {
            const error = code instanceof Error ? code : this.#createError((code + "").toUpperCase(), "Prompt failed.");
            errorEvent = ctx.player.createEvent("google-cast-prompt-error", {
                detail: error,
                trigger: openEvent ?? loadEvent,
                cancelable: true
            });
            ctx.player.dispatch(errorEvent);
            this.#notifyRemoteStateChange(ctx, isCastConnected() ? "connected" : "disconnected", errorEvent);
            throw error;
        } finally{
            ctx.player.dispatch("google-cast-prompt-close", {
                trigger: errorEvent ?? openEvent ?? loadEvent
            });
        }
    }
    async load(ctx) {
        if (__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$vidstack$2f$react$2f$dev$2f$chunks$2f$vidstack$2d$DUlCophs$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["IS_SERVER"]) {
            throw Error("[vidstack] can not load google cast provider server-side");
        }
        if (!this.#player) {
            throw Error("[vidstack] google cast player was not initialized");
        }
        return new (await __turbopack_context__.A("[project]/node_modules/@vidstack/react/dev/chunks/vidstack-CBaoV8XT.js [app-ssr] (ecmascript, async loader)")).GoogleCastProvider(this.#player, ctx);
    }
    async #loadCastFramework(ctx) {
        if (hasLoadedCastFramework()) return;
        const loadStartEvent = ctx.player.createEvent("google-cast-load-start");
        ctx.player.dispatch(loadStartEvent);
        await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$vidstack$2f$react$2f$dev$2f$chunks$2f$vidstack$2d$DUlCophs$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["loadScript"])(getCastFrameworkURL());
        await customElements.whenDefined("google-cast-launcher");
        const loadedEvent = ctx.player.createEvent("google-cast-loaded", {
            trigger: loadStartEvent
        });
        ctx.player.dispatch(loadedEvent);
        if (!isCastAvailable()) {
            throw this.#createError("CAST_NOT_AVAILABLE", "Google Cast not available on this platform.");
        }
        return loadedEvent;
    }
    async #showPrompt(options) {
        this.#setOptions(options);
        const errorCode = await this.cast.requestSession();
        if (errorCode) {
            throw this.#createError(errorCode.toUpperCase(), getCastErrorMessage(errorCode));
        }
    }
    #setOptions(options) {
        this.cast?.setOptions({
            ...getDefaultCastOptions(),
            ...options
        });
    }
    #notifyRemoteStateChange(ctx, state, trigger) {
        const detail = {
            type: "google-cast",
            state
        };
        ctx.notify("remote-playback-change", detail, trigger);
    }
    #createError(code, message) {
        const error = Error(message);
        error.code = code;
        return error;
    }
}
var loader = /*#__PURE__*/ Object.freeze({
    __proto__: null,
    GoogleCastLoader: GoogleCastLoader
});
;
}),
];

//# sourceMappingURL=node_modules_%40vidstack_react_dev_chunks_vidstack-BM-FgV9W_e25d9d1d.js.map