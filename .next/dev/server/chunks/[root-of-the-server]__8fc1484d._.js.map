{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Edward%20Magejo/.gemini/antigravity/playground/inertial-event/src/app/tmdb-img/%5B...path%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\n\r\nexport const dynamic = 'force-dynamic';\r\n\r\nexport async function GET(request: NextRequest) {\r\n    const path = request.nextUrl.pathname.replace(\"/tmdb-img\", \"\");\r\n    const searchParams = request.nextUrl.search;\r\n\r\n    // TMDB image URL structure: https://image.tmdb.org/t/p/{size}/{path}\r\n    // Our request comes as /tmdb-img/{size}/{path}\r\n    // So 'path' from replace will be /{size}/{path}\r\n    const imageUrl = `https://image.tmdb.org/t/p${path}${searchParams}`;\r\n\r\n    console.log(`[TMDB-IMG] URL: ${imageUrl}`);\r\n\r\n    try {\r\n        const response = await fetch(imageUrl, {\r\n            headers: {\r\n                'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36',\r\n                'Referer': 'https://www.themoviedb.org/',\r\n            }\r\n        });\r\n\r\n        if (!response.ok) {\r\n            console.error(`[TMDB-IMG] TMDB responded with ${response.status} for ${imageUrl}`);\r\n            return new NextResponse(null, { status: response.status });\r\n        }\r\n\r\n        const buffer = await response.arrayBuffer();\r\n        return new NextResponse(Buffer.from(buffer), {\r\n            headers: {\r\n                'Content-Type': response.headers.get('content-type') || 'image/jpeg',\r\n                'Cache-Control': 'public, max-age=31536000, immutable',\r\n                'Access-Control-Allow-Origin': '*'\r\n            }\r\n        });\r\n    } catch (error: any) {\r\n        console.error(`[TMDB-IMG] Critical Error: ${error.message}`);\r\n        return new NextResponse(null, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEO,MAAM,UAAU;AAEhB,eAAe,IAAI,OAAoB;IAC1C,MAAM,OAAO,QAAQ,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,aAAa;IAC3D,MAAM,eAAe,QAAQ,OAAO,CAAC,MAAM;IAE3C,qEAAqE;IACrE,+CAA+C;IAC/C,gDAAgD;IAChD,MAAM,WAAW,CAAC,0BAA0B,EAAE,OAAO,cAAc;IAEnE,QAAQ,GAAG,CAAC,CAAC,gBAAgB,EAAE,UAAU;IAEzC,IAAI;QACA,MAAM,WAAW,MAAM,MAAM,UAAU;YACnC,SAAS;gBACL,cAAc;gBACd,WAAW;YACf;QACJ;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YACd,QAAQ,KAAK,CAAC,CAAC,+BAA+B,EAAE,SAAS,MAAM,CAAC,KAAK,EAAE,UAAU;YACjF,OAAO,IAAI,gJAAY,CAAC,MAAM;gBAAE,QAAQ,SAAS,MAAM;YAAC;QAC5D;QAEA,MAAM,SAAS,MAAM,SAAS,WAAW;QACzC,OAAO,IAAI,gJAAY,CAAC,OAAO,IAAI,CAAC,SAAS;YACzC,SAAS;gBACL,gBAAgB,SAAS,OAAO,CAAC,GAAG,CAAC,mBAAmB;gBACxD,iBAAiB;gBACjB,+BAA+B;YACnC;QACJ;IACJ,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,CAAC,2BAA2B,EAAE,MAAM,OAAO,EAAE;QAC3D,OAAO,IAAI,gJAAY,CAAC,MAAM;YAAE,QAAQ;QAAI;IAChD;AACJ"}}]
}